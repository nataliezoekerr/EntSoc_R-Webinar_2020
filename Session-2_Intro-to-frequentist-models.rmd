---
title: 'Session 2: Introduction to frequentist models in R'
author: "Natalie Z. Kerr & Brian Lovett"
date: "9/7/2020"
output: html_document
---

**Description:** Here, we will cover how to run general linear models (**LMs**; e.g., Gaussian/Normal distribution), generalized linear models (**GLMs**; e.g., binomial, Poisson for count data), and mixed models (**LMMs/GLMMs**; e.g., fixed vs. random effects). We will also expand on models using Poisson-distributed data by evaluating how to deal with common issues such as when your count data are over-dispersed/under-dispersed (e.g., Poisson vs. Negative Binomial vs. Conway-Maxwell-Poisson), when counts should be represented as rates (e.g., counts per unit time using Poisson offsets), and when your count data are zero-inflated (e.g., 0-inflated regression vs hurdle models). Finally, we will finish the session on appropriate ways to run model selection techniques for finding a winning model from a set of candidate models, using likelihood ratio tests for nested models and Akaike Information Criteria (AIC). This course will not be a statistics course, so people will need to be familiar with most of these models.


## 1. Packages required

Here, is a list of packages required for this R course. You will need to install these prior to the class, either install from the "packages" panel in R studio or using the function below. 

> install.package("")

Once installed, we can run these packages in advance. I will inform you whenever we are running a function from each of these packages throughout this session. 

```{r Packages required, echo = F }

library(pscl) # for zero-inflated regression models
library(glmmTMB) # for glmmTMB::glmmTMB() for hurdle models, e.g., truncated_Poisson(), and for under-dispersed Poisson data, compois()

library(lme4) # lme4::glmer() for mixed models

library(car) # for likelihood ratio tests
library(lmtest) # for likelihood ratio tests

library(bbmle) # for AIC

```


## 2. Introduction to general linear models, LMs

Here, we will explore how to use general linear models in program R for when you have normally distributed-data. I will introduce the 

```{r}

```


## 3. Introduction to general*ized* linear models, GLMs


### i. Binomial proccesses

Here, we will use generalized linear models to estimate a response that is binomial, e.g., successes vs. failures (or k events and N trials) or presence/absense data. 


```{r}

```

### ii. Count data

```{r}


```


### iii. Gaussian vs. Gamma

```{r}


```


## 4. Common issues for Poisson-distributed data

### i. When data are over-dispersed or under-dispersed

A common issue when fitting Poisson models is overdispersion, i.e., when count data has more variability than expected for a Poisson distribution. For Poisson models, data are less likely to be underdispersed for this given distribution. However, this is still likely to happen for biological data. Such as 



```{r Overdispersion }


```


Undispersion is more common in ecology with species that have small clutch/litter sizes. For example, when a bird may only lay up to 6 eggs per clutch.

```{r Underdispersion }


```


### ii. When counts should be rates 

A common issue in ecology is when each observtion of count data are not always equally in represented. For example, you may find yourself in a situation where each observation is collected over different lengths of time or you count a number out of a total number.  

```{r Poisson offsets }




```


## iii. When counts are zero-inflated

Here, we will run two different models when you encounter many zeros in your count data (i.e., zero-inflated count data). We can take two potential approaches: zero-inflated regression or hurdle model. The first assumes that not all zeros are "true" zeros. This can commonly occur due to observation error, e.g., your count data may be number of cells/bees/butterflies seen, but you are not sure that not seeing an individual means that there were actually no individuals present. 

A zero-inflated regression model is required for this process, since not all zeros are true. 



```{r ZIP }

```


```{r Hurdle models }

```



## 5. Mixed models

Fixed effects vs. random effects.

### i. Random-coefficient models

```{r}


```




### ii. Nested random effects

```{r}

```



## 6. Model selection 

Here, I will outline the general procedure for model selection on a set of candidate mixed models. 

```{r}


```




